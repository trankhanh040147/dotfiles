{"fsPath":"/home/khanh/src/0_github/langtut/internal/tui/page/chat/chat.go","fileUuid":"eb38a8c6-5236-4080-ba01-bea6d6e5186e","fileSizeBytes":41813,"numLines":1489,"diffChanges":[{"originalStartLineNumberOneIndexed":134,"originalEndLineNumberExclusiveOneIndexed":134,"modifiedStartLineNumberOneIndexed":134,"modifiedEndLineNumberExclusiveOneIndexed":136,"addedLines":["\t// pendingMode: mode pre-selected on begin screen (Ctrl+K) before first send; session created on send","\tpendingMode string"],"tokenizedAddedLines":[1000827,1000828]},{"originalStartLineNumberOneIndexed":282,"originalEndLineNumberExclusiveOneIndexed":282,"modifiedStartLineNumberOneIndexed":284,"modifiedEndLineNumberExclusiveOneIndexed":285,"addedLines":["\t\tp.pendingMode = \"\""],"tokenizedAddedLines":[1000829]},{"originalStartLineNumberOneIndexed":446,"originalEndLineNumberExclusiveOneIndexed":447,"modifiedStartLineNumberOneIndexed":449,"modifiedEndLineNumberExclusiveOneIndexed":450,"addedLines":["\t\treturn p, p.handleModeSelected(msg.Mode)"],"tokenizedAddedLines":[1000830]},{"originalStartLineNumberOneIndexed":451,"originalEndLineNumberExclusiveOneIndexed":451,"modifiedStartLineNumberOneIndexed":454,"modifiedEndLineNumberExclusiveOneIndexed":455,"addedLines":["\t\tp.pendingMode = \"\""],"tokenizedAddedLines":[1000829]},{"originalStartLineNumberOneIndexed":873,"originalEndLineNumberExclusiveOneIndexed":873,"modifiedStartLineNumberOneIndexed":877,"modifiedEndLineNumberExclusiveOneIndexed":878,"addedLines":["\tp.pendingMode = \"\""],"tokenizedAddedLines":[1000831]},{"originalStartLineNumberOneIndexed":883,"originalEndLineNumberExclusiveOneIndexed":883,"modifiedStartLineNumberOneIndexed":888,"modifiedEndLineNumberExclusiveOneIndexed":906,"addedLines":["","// handleModeSelected routes mode selection: active session → new session (hard switch);","// begin screen with pending text → create session and send; begin screen without pending → store mode for first send.","func (p *chatPage) handleModeSelected(selectedMode string) tea.Cmd {","\tif p.session.ID != \"\" {","\t\t// Active session: hard switch to new session with selected mode","\t\treturn p.createSessionWithModeAndSend(selectedMode)","\t}","\t// No session (begin screen)","\thasPending := p.pendingMessage != \"\" || len(p.pendingAttachments) > 0","\tif hasPending {","\t\t// User sent first message → mode dialog was shown → create session and send","\t\treturn p.createSessionWithModeAndSend(selectedMode)","\t}","\t// User pressed Ctrl+K without typing: store mode, create session on first send","\tp.pendingMode = selectedMode","\treturn nil","}"],"tokenizedAddedLines":[2,1000832,1000833,1000834,1000835,1000836,1000837,47,1000838,1000839,1000840,1000841,1000837,47,1000842,1000843,566,75]},{"originalStartLineNumberOneIndexed":1009,"originalEndLineNumberExclusiveOneIndexed":1010,"modifiedStartLineNumberOneIndexed":1032,"modifiedEndLineNumberExclusiveOneIndexed":1038,"addedLines":["\t\t// No session: use pre-selected mode if any, else show mode dialog","\t\tif p.pendingMode != \"\" {","\t\t\tp.pendingMessage = text","\t\t\tp.pendingAttachments = attachments","\t\t\treturn p.createSessionWithModeAndSend(p.pendingMode)","\t\t}"],"tokenizedAddedLines":[1000844,1000845,1000846,1000847,1000848,163]}],"gitInfo":{"gitInfo":{"gitRoot":"/home/khanh/src/0_github/langtut","branch":"feat/v0.1.0_write_mode","commitHash":"ccab69e2dccdd4deb43c79cdfbf9d87ea1e9c19d"}},"kind":"KIND_MODIFIED"}